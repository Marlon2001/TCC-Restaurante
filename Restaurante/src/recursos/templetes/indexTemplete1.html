<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>Tamplete Restaurante</title>
    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    <style type="text/css">

        .bg-image-container1{
            background-size: 100% 100%;
            background-repeat: repeat;
        }

        .bg-color-nav{
            background-color: rgba(0, 0, 0, 0.8);
            z-index:100;
        }

        .bg-color-categorias{background-color: rgba(0, 0, 0, 0.5); }
        
        .bg-image-container2{
            width: 100%;
            height: 300px;   
            background-image: url("https://img.freepik.com/fotos-gratis/textura-de-lousa-de-estilo-grunge_1048-10295.jpg?size=626&ext=jpg");
            background-size: 100% 100%;
            background-repeat: repeat;
        }
        
        .carousel-control-prev-icon,
        .carousel-control-next-icon {background-image: none; }

        .carousel-control-next-icon:after
        {
            content: '>';
            font-family: monospace, 'Courier New', Courier;
            font-size: 100px;
            color:rgb(80, 80, 80);
        }

        .carousel-control-prev-icon:after {
            content: '<';
            font-family: monospace, 'Courier New', Courier;
            font-size: 100px;
            color:rgb(80, 80, 80);
        }

        .bg-image-container3{
            background: url("https://voyage-onirique.com/wp-content/uploads/2018/04/WallpaperStudio10-86066.jpg");
            background-size: cover;
            background-position: center;
            background-repeat: repeat;
        }
    </style>
</head>



    <body class="w-100 mx-auto">
        <!-- navbar -->
        <nav id="menu" class="position-fixed navbar bg-color-nav justify-content-around w-100">
            <a class="navbar-brand" href="#">
                <img class="logo rounded float-left" style="max-width: 55px" alt="" />
            </a>
            <ul class="nav justify-content-end w-50">
                <li class="nav-item">
                    <a class="nav-link text-light" href="#menu">Menu</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-light" href="#galeria">Galeria</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-light" href="#sobre">Sobre o Restaurante</a>
                </li>
            </ul>
        </nav>

        <!-- container-inicial -->
        <div class="container-fluid p-0" style="min-height: 600px; max-height: 750px;">
            <img class="w-100" style="min-height: 600px; max-height: 750px;" src="../imgs/imagem.jpg" alt="" />
        </div>

        <!-- Container Sla -->
        <div class="container-fluid bg-image-container2">
            <h1 class="nomeRes pt-2 pb-2 text-center text-light">
                <!-- Nome Restaurante -->
            </h1>

            <div class="d-block">
                <p id="" class="sobreRes h5 text-center text-light">
                    <!-- Descrição Restaurante   -->
                </p>
            </div>
        </div>

        <!-- Container Carousel -->
        <div class="container-fluid" style="min-height: 700px">
            <h1 class="text-center pt-2">MENU</h1>
            <div class="container w-50 mt-3 mb-0">
                <div class="d-flex justify-content-center" id="caixa-categorias">
                    <!-- Categorias -->
                </div>
            </div>
            <hr>
            <!-- carousel -->

            <div class="carousel slide" id="ProdutosRestaurante" data-ride="carousel">

                <ol class="carousel-indicators" id="carousel-indicators">
                    
                </ol>

                <div id="boxCarousel" class="carousel-inner">
                
                    <!-- Item Carousel -->
                </div>

                <!-- SETAS -->
                <a class="carousel-control-prev" href="#ProdutosRestaurante" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#ProdutosRestaurante" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>

        <!-- Container Mais Vendidos -->
        <div class="container-fluid bg-image-container3 p-0" style="min-height: 400px">
            <div class="container-fluid bg-color-nav p-5" style="min-height: inherit">
                <div id="boxMais" class="container w-50 mx-auto">
                    <!-- Titulo -->
                    <h1 class="text-center text-white">Mais Vendidos</h1>
                    
                </div>
            </div>
        </div>

        <!-- Container sobre nós -->
        <div class="container-fluid" style="min-height: 300px">
            <h1 id="titleSobre" class="text-center p-3">Sobre Nós</h1>
            <p id="sobreGodinner" class="sobreRes text-center w-75 text-wrap mx-auto" style="max-height: 300rem">
                <!-- Sobre a Godinne -->
            </p>
            <div id="sobre" class="d-flex flex-row w-75 mx-auto mt-5 justify-content-around">
                <div class="d-flex flex-column">
                    <p>
                        <span class="nomeRes">
                            <!-- Nome Empresa --></span> - <span id="cityRes">
                            <!-- Cidade --> </span>
                    </p>
                </div>
                <div class="d-flex flex-column">
                    Pagamento pelo App GoDinner: Visa , Elo, Amex,
                </div>
            </div>
        </div>

        <!-- Container Galeira -->
        <div class="container-fluid">
            <h1 class="text-center p-3">Galeria de fotos</h1>
            <div class="row justify-content-md-center">
                <div id="galeria" class="col-md-12">

                </div>
            </div>
        </div>

        <script>
            $(document).ready(function () {

                const idRestaurante = 168;
                const DOMAIN = "http://godinner.tk:8080";
                const DOMAINFOTO = "http://fotos.godinner.tk"; 

                // função p pegar informações do restaurante
                function buscarRestaurante() {

                    let url = DOMAIN + `/templates/restaurantes/${idRestaurante}`;

                    $.ajax({

                        url: url,
                        method: 'get',
                        dataType: 'json',
                        contentType: 'application/json',
                        success: function (resposta) {

                            $(".sobreRes").text(resposta.sobre);
                            $(".nomeRes").text(resposta.restaurante.razaoSocial);
                            $("#cityRes").text(resposta.restaurante.endereco.cidade.cidade);
                            $(".logo").attr("src", DOMAINFOTO + "/" + resposta.foto);

                        }.bind(this),
                        error: function (data) {  

                            console.log(data)
                        }
                    });
                }    

                // função p criar carrousel
                function carousel(idCategoria, i = 0){

                    url = DOMAIN + `/categoriaproduto/restaurantes/${idRestaurante}/categorias/${idCategoria}`;
                    
                    $.ajax({
                        url: url,
                        method: 'get',
                        dataType: 'json',
                        contentType: 'application/json',
                        success: function (resposta) {
                            console.log(resposta)
                            const status = i == 0 ? "active" : "";

                            $("#carousel-indicators").append(`<li data-target="#ProdutosRestaurante" data-slide-to="${i}" class="${status}" id="indicator${i}"></li>`);
                            
                            $("#boxCarousel").append(`<div class="carousel-item ${status}">
                                <div class="d-flex justify-content-center p-3" id="categoria${idCategoria}">
            
                                </div>
                            </div>`);
                                
                            let loop = resposta.length <= 3 ? resposta.length : 3;
                            
                            for(let cont = 0; cont < loop; cont++){

                                
                                if(resposta[cont] == undefined)
                                    continue;

                                // Foto padrão
                                if(resposta[cont].foto.length == 0 ){
                                    resposta[cont].foto[0] = JSON.parse('{ "foto": "/restaurante/produto/1572570285790-download (1).jpg"}'); 
                                }
                        
                                $(`#categoria${idCategoria}`).append(`
                                    <div class="card mr-5 float-left" style="width: 18rem;">
                                        <img class="card-img-top" src="${DOMAINFOTO + resposta[cont].foto[0].foto}" alt="Card image cap">
                                        <div class="card-body">
                                            <h5 class="card-title text-center">${resposta[cont].nome}</h5>
                                            <p class="card-text">${resposta[cont].descricao}</p>
                                        </div>
                                    </div>
                                `);
                            }           

                        }.bind(this),
                        error: function (data) {

                            console.log(data)
                        }
                    });
                }

                // função 
                function buscarCategoriasRestaurante() {

                    url = DOMAIN + `/categoriaproduto/categorias/${idRestaurante}`;

                    $.ajax({
                        url: url,
                        method: 'get',
                        dataType: 'json',
                        contentType: 'application/json',
                        success: function (resposta) {
                            console.log(resposta);
                            
                            for (let i in resposta) {
                                
                                $("#caixa-categorias").append(`<div class="m-1 p-0  my-auto">
                                    <figure class="figure m-0">
                                        <img id="cat${i}" class=" img-thumbnail p-0 m-0" style="width:64px; height:64px; cursor: pointer;" src="${DOMAINFOTO +resposta[i].foto}" alt="${resposta[i].nome}" />
                                    </figure>
                                    
                                </div>`);

                                $(`#cat${i}`).click(function(){
                                    $(`#indicator${i}`).trigger("click");
                                });

                                carousel(resposta[i].id, i);
                            }

                        }.bind(this),
                        error: function (data) {
                            console.log(data)
                        }
                    });
                }

                // função p criar mais vendidos
                function maisVendidos(){

                    url = DOMAIN + `/templates/maisvendidos/${idRestaurante}`

                    $.ajax({
                        url: url,
                        method: 'get',
                        dataType: 'json',
                        contentType: 'application/json',
                        success:function(resposta) {

                            let qtdProd = resposta.length <= 5 ? resposta.length : 3;

                            for(let i = 0; i <= qtdProd; i++){
                                
                                if(resposta[i] == undefined)
                                    continue;
                                    
                                $("#boxMais").append(
                                    $(`<div class="d-flex flex-row justify-content-between pt-3 mb-3" style="border-bottom: 3px solid white; border-bottom-style:dotted;">`)
                                        .append($(`<div class="d-flex flex-column text-white">`).append($(`<h3>`).text(resposta[i].nome)),
                                                $(`<div class="d-flex flex-column text-white">`).append($(`<h3>`).text("R$ " + resposta[i].preco.toFixed(2)))
                                        ))
                            }
                        }.bind(this),
                        error: function (data) {

                            console.log(data);
                        }
                    });
                }

                // função p criar galeria
                function galeria(){

                    url = DOMAIN + `/categoriaproduto/categorias/${idRestaurante}`;

                    $.ajax({

                        url: url,
                        method: 'get',
                        dataType: 'json',
                        contentType: 'application/json',
                        success: function (resposta) {
                            
                            for(let i in resposta){

                                $("#galeria").append($(`<figure class="col-md-4 float-left">
                                    <a href="${resposta[i].id}" data-size="1600x1067">
                                        <img alt="${resposta[i].nome}" src="${DOMAINFOTO + resposta[i].foto}" class="img-thumbnail p-0" style=" max-width:300px; max-height:300px;"/>
                                    </a>
                                </figure>`
                                ))
                            }
                        }.bind(this),
                        error: function (data) {

                            console.log(data)
                        }
                    });
                }

                galeria();
                maisVendidos();
                buscarRestaurante();
                buscarCategoriasRestaurante();
            });
        </script>
    </body>

</html>